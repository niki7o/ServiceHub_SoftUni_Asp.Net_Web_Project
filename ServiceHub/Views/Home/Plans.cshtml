@model ServiceHub.Data.Models.ApplicationUser
@using Microsoft.AspNetCore.Identity
@using ServiceHub.Data.Models
@inject UserManager<ApplicationUser> UserManager

@{
    ViewData["Title"] = "Нашите Планове";
    var currentUser = await UserManager.GetUserAsync(User);
    bool isBusinessUser = currentUser != null && await UserManager.IsInRoleAsync(currentUser, "BusinessUser");
    bool isAdmin = currentUser != null && await UserManager.IsInRoleAsync(currentUser, "Admin");
}
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="~/js/Plans.js" asp-append-version="true"></script>
<link rel="stylesheet" href="~/css/plans.css" asp-append-version="true" />

<div class="plans-container">
    <h2 class="page-title">Нашите Планове</h2>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success" role="alert">
            @TempData["SuccessMessage"]
        </div>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger" role="alert">
            @TempData["ErrorMessage"]
        </div>
    }

    <div class="plan-cards-wrapper">
     
        <div class="plan-card">
            <h3>Стандартен План</h3>
            <div class="price">Безплатно</div>
            <ul>
                <li><i class="fas fa-check-circle"></i> Достъп до основни услуги</li>
                <li><i class="fas fa-check-circle"></i> Ограничен брой използвания на премиум услуги</li>
                <li><i class="fas fa-times-circle" style="color: #e63946;"></i> Специално оцветено име</li>
                <li><i class="fas fa-times-circle" style="color: #e63946;"></i> Създаване на шаблони услуги</li>
                <li><i class="fas fa-times-circle" style="color: #e63946;"></i> Приоритетна поддръжка</li>
            </ul>
            <button class="btn-current" disabled>Текущ План</button>
        </div>

     
        <div class="plan-card">
            <h3>Бизнес План</h3>
            <div class="price">€9.99 / месец</div>
            <ul>
                <li><i class="fas fa-check-circle"></i> Неограничен достъп до всички услуги</li>
                <li><i class="fas fa-check-circle"></i> Възможност за създаване на шаблони услуги</li>
                <li><i class="fas fa-check-circle"></i> Приоритетна поддръжка</li>
                <li><i class="fas fa-check-circle"></i> Специално оцветено име</li>
               
                
            </ul>
            @if (isBusinessUser || isAdmin)
            {
                <button class="btn-current" disabled>Вече сте Бизнес Потребител</button>
            }
            else
            {
                <button id="openPaymentModalButton" class="btn-upgrade">Надграждане до Бизнес</button>
            }
        </div>
    </div>
</div>


<div id="paymentModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Плащане за Бизнес План</h2>
        <form id="paymentForm">
            <div class="form-group">
                <label for="cardNumber">Номер на карта (Mastercard):</label>
                <input type="text" id="cardNumber" class="form-control" placeholder="XXXX XXXX XXXX XXXX" maxlength="19">
                <span class="validation-message" id="cardNumberError"></span>
            </div>
            <div class="form-group">
                <label for="cardName">Име на картодържателя:</label>
                <input type="text" id="cardName" class="form-control" placeholder="Име Фамилия">
                <span class="validation-message" id="cardNameError"></span>
            </div>
            <div class="form-row">
                <div class="form-group">z
                    <label for="expiryDate">Валидност (MM/YY):</label>
                    <input type="text" id="expiryDate" class="form-control" placeholder="ММ/ГГ" maxlength="5">
                    <span class="validation-message" id="expiryDateError"></span>
                </div>
                <div class="form-group">
                    <label for="cvc">CVC:</label>
                    <input type="text" id="cvc" class="form-control" placeholder="XXX" maxlength="4">
                    <span class="validation-message" id="cvcError"></span>
                </div>
            </div>
            <button type="submit" id="payButton" class="payment-button">Плати сега</button>
            <div id="loadingSpinner" class="loading-spinner"></div>
            <div id="paymentMessage" class="alert-message"></div>
        </form>
    </div>
</div>


